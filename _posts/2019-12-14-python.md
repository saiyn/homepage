---
layout: post
title:  "python开发笔记"
date:   2019-12-14 15:15:54
categories: Language
excerpt: python3 flask
---

* content
{:toc}

记录Python开发中的知识点

---

# 基于flask的开发

## 构建flask后台开发环境

### docker部署flask + uwsgi + gevent实现websocket

<br />

完成demo工程参见[github](https://github.com/saiyn/websocket-test)
docker镜像 `docker pull saiyn/websocket:v0.0.2`

在实现demo的时候踩了一些坑，其他之一是uwsgi低于2.0.19的版本都不能和gevent新版本兼容，会出现[这样的bug](https://github.com/unbit/uwsgi/issues/2144)

<br />


# virtulenv的运用

<br />

在基于venv开发和管理python依赖库时首先会碰到的就是venv的迁移问题，比如开始是在本地开发的，后面要上线到AWS。

* 创建venv

    $python3 -m venv myvenv
    
    $cd myvenv
    
    $source bin/activate
    
    $pip install -r requirement.txt
    
<br /> 
  
## sudo后提示无法找到python的问题

<br />

在执行`source ./myenv/bin/activate`后，这时我们执行`python3 xxx.py`运行代码是没有问题的，但是执行`sudo python3 xx.py`后就发现会报无法找到python的问题。

这是因为，在我们执行`source ./myenv/bin/activate`后，venv中的python路径会被添加到`$PATH`中去，但是，为了安全，sudo执行程序时，系统会忽略`$PATH`，所以导致无法定位python程序位置的问题。

解决方法之一就是,执行`sudo ./myenv/bin/python3 xxx.py`，显示的给出python所在路径。




<br />

# 安装uwsgi

<br />

在执行pip install uwsgi之前先要执行`sudo apt-get install python3-dev`，否则会出现"fatal error: Python.h: No such file or directory"的错误





